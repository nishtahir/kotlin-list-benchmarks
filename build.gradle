plugins {
    id 'org.jetbrains.kotlin.jvm' version '1.4-M2-eap-72'
    id 'kotlinx.benchmark' version '0.2.0-mpp-dev-5'
    id 'org.jetbrains.kotlin.plugin.allopen' version "1.4-M2-eap-72"
}

group 'com.nishtahir'
version '1.0-SNAPSHOT'

allOpen {
    annotation("org.openjdk.jmh.annotations.State")
}

repositories {
    mavenCentral()
    maven { url 'https://dl.bintray.com/kotlin/kotlin-dev' }
    maven { url 'https://dl.bintray.com/kotlin/kotlinx' }
}

sourceSets {
    benches
}

sourceSets.all {
    kotlin.srcDirs = ["src/$it.name/kotlin"]
    resources.srcDirs = ["src/$it.name/resources"]
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

compileBenchesKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

benchmark {
    targets {
        register("benches") {
            jmhVersion = "1.21"
        }
    }
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.4-M2-eap-72"
    implementation "org.jetbrains.kotlinx:kotlinx.benchmark.runtime-jvm:0.2.0-mpp-dev-5"
    benchesCompile sourceSets.main.output + sourceSets.main.runtimeClasspath
}
